# 第12节：函数进阶

### 一、概述

主要讲解：

* 立即执行函数
* 闭包
* 函数默认值
* 箭头函数
* async函数

### 二、立即执行函数

 就是声明之后立刻执行的函数。用于封装代码，ES6不常见了

```js
(function(){
    console.log("hello world");
})()
```

函数体被小括号包裹，然后后面紧跟着一个小括号。

### 三、闭包

指定义在函数内部的函数，

```js
//用立即执行函数编写一个闭包
(function(){
    function add(a,b){
        return a+b;
    }
    let result = add(10,20);
    console.log(result);
    
})
```

这里的add函数就是一个闭包，特点是具有全局性，闭包内部的this关键字会指向全局对象window

### 四、函数默认值

```js
//在ES5之前，使用逻辑或运算符给参数赋默认值
function fun1(x,y){
    x = x|| 100; // x的默认值是100
    y = y|| 200; // y的默认值是200
    return x+y;
}
// 上述方式很不友好，ES6使用如下方式
function fun2(x=100, y=200){
    return x+y;
}
```

### 五、箭头函数

定义函数的三种方式：

* 函数声明
* 函数表达式
* 剪头函数：使用=>来定义函数

```js
//函数声明
function add(a,b){
    return a+b
}
//函数表达式
const add = function(a,b){
    return a+b
}
//箭头函数
const add = (a,b) => {
    return a+b;
}
```

* =>左侧表示存放参数，右侧表示存放函数体
* 如果函数只有一个形参可以省略参数小括号
* 如果函数体只有一个表达式作为返回值，可以省略花括号和return关键字

```js
const fun = x =>x*x
```

#### 箭头函数中的this

此前的this指向谁，取决于哪个对象调用了这个函数。

而箭头函数中this指向定义函数的时候的对象而不是调用函数的时候

```js
const person = {
    sayMe:function(){
        console.log(this);
    },
    sayMeDelay:function(){
        (function(){
            console.log(this);
        })()
    }
}
person.sayMe(); //这里this指向的是person对象，因为person对象调用sayMe
person.sayMeDelay(); //这里this执行window对象，这里方法里面加入一个立即执行函数，这个函数由window对象调用
// 使用箭头函数的this指向定义函数的对象
sayMeDelay:function(){
    (() => {
        console.log(this);
    })()
}
```



