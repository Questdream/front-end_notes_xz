# 第16节：事件流

### 一、绑定事件

绑定事件的两种方法：内联事件和事件监听器。

```js
<button id="btn1">按钮1</button>
<button id="btn2">按钮2</button>
<script>
    //先获取节点元素
    var btn1 = document.querySelector("#btn1");
	var btn2 = document.querySelector("#btn2");

	// 内联事件来为元素绑定事件
	btn1.onclick = function(){
        console.log("我是按钮1")；
    }
	// 事件监听器
	btn2.addEventListener("click",function(){
        console.log("我是按钮2");
    })
```

可以实现相同的效果，主要区别在于：

addEventListener可以无限制的为元素绑定事件，即多次事件都能触发

而内联事件后面的会覆盖前面的绑定事件，即只触发最后一次绑定

### 二、事件冒泡与事件捕获

当元素一层层嵌入时而重叠，那么点击重叠元素时，事件触发顺序怎么样？

比如，为三个一层层嵌入的div元素绑定点击事件，最外层宽高为300px,中间层为200px，内层为100px，点击最内层，事件如何触发，由内到外，还是由外到内？

```js
<div class="box1">
    <div class="box2">
        <div class="box3"></div>
	</div>
</div>
// 获得元素节点
var box1 = document.querySelector(".box1");
var box2 = document.querySelector(".box2");
var box3 = document.querySelector(".box3");
// 绑定点击事件
box1.addEventListener("click",function(){
    console.log("我是box1")；
})
box2.addEventListener("click",function(){
    console.log("我是box2")；
})
box3.addEventListener("click",function(){
    console.log("我是box3")；
})
```

输出顺序是box3-box2-box1,表示事件是从内层开始触发，然后依次向外。

事件流有两个阶段：事件捕获阶段和事件冒泡阶段

* 事件捕获阶段是从最外层元素开始一层层进入到最内层
* 事件冒泡阶段是从最内层流向最外层

事件默认情况下是在冒泡阶段触发，因此为从内到外触发

也可以通过在添加事件的方法第三个参数设置为true时，事件会在捕获阶段触发

注意：addEventListener方法第一个参数为事件（如click），第二个参数为触发函数，第三个参数就是设置触发顺序，默认为false，从内到外触发。

### 三、事件委托

利用事件流的原理，实现**事件委托**。即将子级的事件委托给父级来处理。

希望点击所有的按钮就输出按钮的文本内容：

```js
<div class="btnBox">
    <button class="btn1">按钮1</button>
	<button class="btn2">按钮2</button>
	<button class="btn3">按钮3</button>
	<button class="btn4">按钮4</button>
</div>
// 获取按钮元素
var btnArray = document.querySelectorAll("button");
// 循环遍历绑定所有按钮
for(var i=0; i<btnArray.length;i++){
    btnArray[i].addEventListener("click",function(){
        console.log(this.innerHTML);
    })
}
```

如果按钮太多会通过一个个绑定会影响性能，而且通过js新增了一个按钮，这个按钮因为没有初始化没有绑定不了事件，因此可以通过事件委托实现

```js
var btnBox = document.querySelector(".btnBox");
btnBox.addEventListener("click", function(envet){
    var target = envet.target;//通过事件对象获取事件目标
    console.log(target.innerHTML);
})
```

事件委托，即在事件监听函数中，在第二个函数参数的形参设置为event，其包含事件相关信息，通过event.target可以获取到我们的事件目标，即点击按钮

而吗事件绑定的是按钮的容器，这样就可以将自己元素的事件委托给父级来处理。