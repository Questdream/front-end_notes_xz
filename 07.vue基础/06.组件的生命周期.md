# 第06节：组件的生命周期

### 一、概念

组件什么时候加载，什么时候发送后台数据请求等就需要了解组件的生命周期钩子函数。

### 二、生命周期

一个组件被创建出来最后被销毁所要经历的一系列过程，就叫一个组件的生命周期图。

一个组件从被创建到最后被销毁，总共要经历8个过程：

1. beforeCreate:组件创建之前
2. created：组件创建完毕
3. beforeMount：组件被挂载之前
4. mounted：组件挂载完毕
5. beforeUpdate：组件更新之前
6. updated：组件更新完毕
7. beforeDestroy：组件销毁之前
8. destroyed：组件销毁完毕

### 三、代码演示

```js
<body>
    <div id="app">
        <h1>{{message}}</h1>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/vue"></script>
    <script>
        var app =new Vue({
            el:"#app",
            data:{
                message:"vue组件的生命周期"
            },
            //组件被创建之前
            beforeCreate(){
                console.group("beforeCreate组件创建之前状态")
                console.log("%C%S","color:red","el:"+this.$el);
                console.log("%C%S","color:red","data:"+this.$data);
                console.log("%C%S","color:red","message:"+this.message);
            },
            // 组件创建完毕
            created(){
                console.group("created组件创建完毕状态")
                console.log("%C%S","color:red","el:"+this.$el);
                console.log("%C%S","color:red","data:"+this.$data);
                console.log("%C%S","color:red","message:"+this.message);
            },
            // 组件挂载之前
            beforeMount(){
                console.group("beforeMount组件挂载之前状态")
                console.log("%C%S","color:red","el:"+this.$el);
                console.log(this.$el);
                console.log("%C%S","color:red","data:"+this.$data);
                console.log("%C%S","color:red","message:"+this.message);
            },
            // 组件挂载完毕
            mounted(){
                console.group("mount组件挂载完毕状态")
                console.log("%C%S","color:red","el:"+this.$el);
                console.log(this.$el);
                console.log("%C%S","color:red","data:"+this.$data);
                console.log("%C%S","color:red","message:"+this.message);
            },
            // 组件更新之前
           beforeUpdate(){
                console.group("beforeUpdata组件更新之前状态")
                console.log("%C%S","color:red","el:"+this.$el);
                console.log(this.$el);
                console.log("%C%S","color:red","data:"+this.$data);
                console.log("%C%S","color:red","message:"+this.message);
            },
            // 组件跟新完毕
           updated(){
                console.group("updated组件更新完毕状态")
                console.log("%C%S","color:red","el:"+this.$el);
                console.log(this.$el);
                console.log("%C%S","color:red","data:"+this.$data);
                console.log("%C%S","color:red","message:"+this.message);
            },
            // 组件销毁之前
            beforeDestroy(){
                console.group("beforeDestroy组件销毁之前状态")
                console.log("%C%S","color:red","el:"+this.$el);
                console.log(this.$el);
                console.log("%C%S","color:red","data:"+this.$data);
                console.log("%C%S","color:red","message:"+this.message);
            },
            // 组件销毁完毕
            destroyed(){
                console.group("destroyed组件销毁完毕状态")
                console.log("%C%S","color:red","el:"+this.$el);
                console.log(this.$el);
                console.log("%C%S","color:red","data:"+this.$data);
                console.log("%C%S","color:red","message:"+this.message);
            }

        })
    </script>
</body>
```

### 四、各个过程详解

#### 1.beforeCreate和created

在组件创建之前beforeCreate：组件的el和data都未被创建

在组件创建完毕后created：组件的数据data已经被创建好，但是el还处于未被创建状态

#### 2.beforeMount和mounted

在组件挂载之前beforeMount：组件el就会被创建，虽然data里的message早已经被创建好，但是它还未能被应用到真实的DOM元素中。

在组件挂载完毕mounted：组件的el，data都已经全部被创建好，并且data里的message也已经被正确的挂载应用到了DOM元素中。

#### 3.beforeUpdate和updated

当组件的数据被改变时会调用这两个钩子函数，比如在控制台输入app.message=123,由于组件中data里面的message的值改变，就会触发组件的beforeUpadate和update钩子函数。

#### 4.beforeDestroy和destroyed

某种业务场景下，我没期望缓存的页面可以被销毁，就会调用$destroy方法，即app.$destroy()，在控制台输入后，就会调用这两个钩子函数。

至此，整个组件便走完自己的一生，从创建到被销毁，销毁之后该组件将不受vue管理，组件上所有的监听事件和指令都会被移除和解绑。

##### 总结

以上就是vue中组件生命周期钩子函数执行的各个过程以及执行的时机，用法举例：

假如有个表格组件：

1. 我没想在表格加载之前显示loading图，那么我们可以在组件创建之前的钩子函数beforeCreate里面将loading图显示。
2. 当组件加载出来，我们可以在created钩子函数中让这个loading图消失。
3. 当表格被加载好了之后想让它马上去拉去后台数据，那么我没可以在组件挂载之前的钩子函数beforeMount里面去发送请求。



